import{b as p,l as h,m as N,c as n,o as i,a as t,e as _,k as w,F as C,j as S,w as V,t as r,d as g,v as f,u as v,S as M,p as P}from"./index-c-ZVSFtC.js";import{s as E}from"./request-rDDBDBrE.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"kv-manager-page"},U={class:"content-card"},$={class:"table-wrapper"},B={class:"kv-table"},j={class:"value-cell"},q={class:"value-text"},G={class:"actions-cell"},J=["onClick"],O=["onClick"],z=["onClick"],Q={key:0},W={colspan:"5",class:"empty-state"},X={key:0,class:"modal-overlay"},Y={class:"modal-content"},Z={class:"form-group"},tt={class:"form-group"},et={class:"form-group"},at={__name:"Mercury",setup(st){const o=p([{id:1,key:"my-app:config:theme",value:'"dark"',tags:["config","ui"],updated_at:"2023-10-27 10:30:15"},{id:2,key:"user:101:permissions",value:'["read", "write", "comment"]',tags:["user","security"],updated_at:"2023-10-26 18:05:01"}]),d=p(!1),c=p(!1),a=rf(null),m=P(),x=h(()=>c.value?"Edit KV Pair":"Create KV Pair"),A={FETCH:"/FetchData/fetch"},y=h({get(){return a.value?.tags?.join(",")||""},set(s){a.value&&(a.value.tags=s.split(/[,\s\.，。]+/).map(e=>e.trim()).filter(e=>e))}});function D(){m.push({name:"Index"})}function H(){localStorage.removeItem("AuthToken"),m.push({name:"RegisterAndLogin"})}function k(){c.value=!1,a.value={key:"",value:"",tags:[]},d.value=!0}function T(s){c.value=!0,a.value={...s},d.value=!0}function b(){d.value=!1,a.value=null}async function I(){if(a.value){if(c.value){console.log("Updating item:",a.value);const s=o.value.findIndex(e=>e.id===a.value.id);s!==-1&&(o.value[s]={...a.value,updated_at:new Date().toLocaleString()})}else{console.log("Creating new item:",a.value);const s={...a.value,id:Date.now(),updated_at:new Date().toLocaleString()};o.value.unshift(s)}b()}}function K(s){confirm(`Are you sure you want to delete the key "${s.key}"?`)&&(console.log("Deleting item:",s),o.value=o.value.filter(e=>e.id!==s.id))}const L=async()=>{localStorage.getItem("user_id");try{const s=await E.get(A.FETCH)}catch{console.error("获取后端数据失败,账号异常请重新登录"),M("获取后端数据失败,账号异常请重新登录")}};return N(()=>{L()}),(s,e)=>(i(),n("div",R,[t("div",U,[t("button",{class:"btn-return",onClick:D,title:"Go back"},e[3]||(e[3]=[t("i",{class:"fas fa-arrow-left"},null,-1)])),t("header",{class:"kv-manager-header"},[e[6]||(e[6]=t("h1",null,"KV Store",-1)),t("div",{class:"toolbar"},[e[5]||(e[5]=t("input",{type:"text",class:"search-input",placeholder:"Search by key or tag...","aria-label":"Search Key-Value pairs"},null,-1)),t("button",{class:"btn-primary",onClick:k}," + Add New "),t("button",{class:"btn-ghost",onClick:H,title:"Logout and login again"},e[4]||(e[4]=[t("i",{class:"fas fa-sign-out-alt"},null,-1),w(" Re-Login ")]))])]),t("div",$,[t("table",B,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",{class:"col-key"},"Key"),t("th",{class:"col-value"},"Value"),t("th",{class:"col-tags"},"Tags"),t("th",{class:"col-updated"},"Last Updated"),t("th",{class:"col-actions"},"Actions")])],-1)),t("tbody",null,[(i(!0),n(C,null,S(o.value,l=>(i(),n("tr",{key:l.id},[t("td",null,r(l.key),1),t("td",j,[t("span",q,r(l.value),1)]),t("td",null,[(i(!0),n(C,null,S(l.tags,u=>(i(),n("span",{key:u,class:"tag"},r(u),1))),128))]),t("td",null,r(l.updated_at),1),t("td",G,[t("button",{class:"btn-icon",title:"View History",onClick:u=>s.handleViewHistory(l)},e[7]||(e[7]=[t("i",{class:"fas fa-history"},null,-1)]),8,J),t("button",{class:"btn-icon",title:"Edit",onClick:u=>T(l)},e[8]||(e[8]=[t("i",{class:"fas fa-pencil-alt"},null,-1)]),8,O),t("button",{class:"btn-icon btn-danger",title:"Delete",onClick:u=>K(l)},e[9]||(e[9]=[t("i",{class:"fas fa-trash-alt"},null,-1)]),8,z)])]))),128)),o.value.length?_("",!0):(i(),n("tr",Q,[t("td",W,[e[10]||(e[10]=w(" No Key-Value pairs found. ")),t("a",{href:"#",onClick:V(k,["prevent"])},"Add one now!")])]))])])]),e[12]||(e[12]=t("footer",{class:"kv-manager-footer"},[t("div",{class:"pagination"},[t("span",null,"Page 1 of 1"),t("button",{class:"btn-ghost",disabled:""},"< Prev"),t("button",{class:"btn-ghost",disabled:""},"Next >")])],-1))]),d.value?(i(),n("div",X,[t("div",Y,[t("form",{onSubmit:V(I,["prevent"])},[t("h1",null,r(x.value),1),t("div",Z,[g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>v(a).key=l),id:"kv-key",type:"text",placeholder:"Key (e.g., app:settings:retries)",required:""},null,512),[[f,v(a).key]])]),t("div",tt,[g(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>v(a).value=l),id:"kv-value",rows:"5",placeholder:"Value (string or valid JSON)"},null,512),[[f,v(a).value]])]),t("div",et,[g(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>y.value=l),id:"kv-tags",type:"text",placeholder:"Tags (comma separated, e.g., api,config,user)"},null,512),[[f,y.value]])]),t("div",{class:"modal-actions"},[t("button",{type:"button",class:"btn-ghost",onClick:b},"Cancel"),e[13]||(e[13]=t("button",{type:"submit",class:"btn-primary"},"Save",-1))])],32)])])):_("",!0)]))}},it=F(at,[["__scopeId","data-v-f7a8242e"]]);export{it as default};

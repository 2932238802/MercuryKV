import{b as v,l as k,m as L,c as n,o as i,a as t,e as h,k as _,F as w,j as C,w as S,t as r,d as p,v as g,S as N,u as M}from"./index-BFUAgGEI.js";import{s as P}from"./request-rDDBDBrE.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"kv-manager-page"},R={class:"content-card"},U={class:"table-wrapper"},$={class:"kv-table"},B={class:"value-cell"},j={class:"value-text"},q={class:"actions-cell"},G=["onClick"],J=["onClick"],O=["onClick"],z={key:0},Q={colspan:"5",class:"empty-state"},W={key:0,class:"modal-overlay"},X={class:"modal-content"},Y={class:"form-group"},Z={class:"form-group"},tt={class:"form-group"},et={__name:"Mercury",setup(at){const o=v([]),d=v(!1),c=v(!1),a=v(null),f=M(),V=k(()=>c.value?"Edit KV Pair":"Create KV Pair"),x={FETCH:"/FetchData/fetch"},m=k({get(){return a.value?.tags?.join(",")||""},set(s){a.value&&(a.value.tags=s.split(/[,\s\.，。]+/).map(e=>e.trim()).filter(e=>e))}});function A(){f.push({name:"Index"})}function D(){localStorage.removeItem("AuthToken"),f.push({name:"RegisterAndLogin"})}function y(){c.value=!1,a.value={key:"",value:"",tags:[]},d.value=!0}function H(s){c.value=!0,a.value={...s},d.value=!0}function b(){d.value=!1,a.value=null}async function T(){if(a.value){if(c.value){console.log("Updating item:",a.value);const s=o.value.findIndex(e=>e.id===a.value.id);s!==-1&&(o.value[s]={...a.value,updated_at:new Date().toLocaleString()})}else{console.log("Creating new item:",a.value);const s={...a.value,id:Date.now(),updated_at:new Date().toLocaleString()};o.value.unshift(s)}b()}}function I(s){confirm(`Are you sure you want to delete the key "${s.key}"?`)&&(console.log("Deleting item:",s),o.value=o.value.filter(e=>e.id!==s.id))}const K=async()=>{const s=localStorage.getItem("user_id");try{o=(await P.get(x.FETCH,{params:s})).data}catch(e){console.error("获取后端数据失败,账号异常请重新登录"),N(e.message)}};return L(()=>{K()}),(s,e)=>(i(),n("div",F,[t("div",R,[t("button",{class:"btn-return",onClick:A,title:"Go back"},e[3]||(e[3]=[t("i",{class:"fas fa-arrow-left"},null,-1)])),t("header",{class:"kv-manager-header"},[e[6]||(e[6]=t("h1",null,"KV Store",-1)),t("div",{class:"toolbar"},[e[5]||(e[5]=t("input",{type:"text",class:"search-input",placeholder:"Search by key or tag...","aria-label":"Search Key-Value pairs"},null,-1)),t("button",{class:"btn-primary",onClick:y}," + Add New "),t("button",{class:"btn-ghost",onClick:D,title:"Logout and login again"},e[4]||(e[4]=[t("i",{class:"fas fa-sign-out-alt"},null,-1),_(" Re-Login ")]))])]),t("div",U,[t("table",$,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",{class:"col-key"},"Key"),t("th",{class:"col-value"},"Value"),t("th",{class:"col-tags"},"Tags"),t("th",{class:"col-updated"},"Last Updated"),t("th",{class:"col-actions"},"Actions")])],-1)),t("tbody",null,[(i(!0),n(w,null,C(o.value,l=>(i(),n("tr",{key:l.id},[t("td",null,r(l.key),1),t("td",B,[t("span",j,r(l.value),1)]),t("td",null,[(i(!0),n(w,null,C(l.tags,u=>(i(),n("span",{key:u,class:"tag"},r(u),1))),128))]),t("td",null,r(l.updated_at),1),t("td",q,[t("button",{class:"btn-icon",title:"View History",onClick:u=>s.handleViewHistory(l)},e[7]||(e[7]=[t("i",{class:"fas fa-history"},null,-1)]),8,G),t("button",{class:"btn-icon",title:"Edit",onClick:u=>H(l)},e[8]||(e[8]=[t("i",{class:"fas fa-pencil-alt"},null,-1)]),8,J),t("button",{class:"btn-icon btn-danger",title:"Delete",onClick:u=>I(l)},e[9]||(e[9]=[t("i",{class:"fas fa-trash-alt"},null,-1)]),8,O)])]))),128)),o.value.length?h("",!0):(i(),n("tr",z,[t("td",Q,[e[10]||(e[10]=_(" No Key-Value pairs found. ")),t("a",{href:"#",onClick:S(y,["prevent"])},"Add one now!")])]))])])]),e[12]||(e[12]=t("footer",{class:"kv-manager-footer"},[t("div",{class:"pagination"},[t("span",null,"Page 1 of 1"),t("button",{class:"btn-ghost",disabled:""},"< Prev"),t("button",{class:"btn-ghost",disabled:""},"Next >")])],-1))]),d.value?(i(),n("div",W,[t("div",X,[t("form",{onSubmit:S(T,["prevent"])},[t("h1",null,r(V.value),1),t("div",Y,[p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.key=l),id:"kv-key",type:"text",placeholder:"Key (e.g., app:settings:retries)",required:""},null,512),[[g,a.value.key]])]),t("div",Z,[p(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.value=l),id:"kv-value",rows:"5",placeholder:"Value (string or valid JSON)"},null,512),[[g,a.value.value]])]),t("div",tt,[p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>m.value=l),id:"kv-tags",type:"text",placeholder:"Tags (comma separated, e.g., api,config,user)"},null,512),[[g,m.value]])]),t("div",{class:"modal-actions"},[t("button",{type:"button",class:"btn-ghost",onClick:b},"Cancel"),e[13]||(e[13]=t("button",{type:"submit",class:"btn-primary"},"Save",-1))])],32)])])):h("",!0)]))}},nt=E(et,[["__scopeId","data-v-09c93bae"]]);export{nt as default};
